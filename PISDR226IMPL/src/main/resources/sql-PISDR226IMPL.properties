PISD.SQL_UPDATE.BIOMETRIC=conPISD;UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET BIOMETRIC_KEY_ID = :BIOMETRIC_KEY_ID,USER_AUDIT_ID = :USER_AUDIT_ID,AUDIT_DATE = SYSTIMESTAMP WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.SQL_SELECT_CONTRACT=conPISD;SELECT COUNT(*) COUNT FROM PISD.T_PISD_INSURANCE_PRODUCT WHERE C.BIOMETRIC_KEY_ID = :BIOMETRIC_KEY_ID
PISD.FIND_CONTRACT_REGISTERED=conPISD; SELECT POLICY_ID, TO_CHAR(INSURANCE_CONTRACT_START_DATE,'YYYY-MM-DD') AS INSURANCE_CONTRACT_START_DATE, TO_CHAR(INSURANCE_CONTRACT_END_DATE,'YYYY-MM-DD') AS INSURANCE_CONTRACT_END_DATE, CUSTOMER_ID, PREMIUM_AMOUNT, INSRNC_CO_CONTRACT_STATUS_TYPE, CONTRACT_STATUS_ID FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID AND INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID  
PISD.VALIDATE_IF_QUOTATION_EXISTS_IN_CONTRACT=conPISD; SELECT COUNT(POLICY_QUOTA_INTERNAL_ID) AS RESULT_NUMBER FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID AND CREATION_DATE >= TRUNC(SYSDATE - 30) 
PISD.SELECT_PAYMENT_PERIOD=conPISD; SELECT PAYMENT_FREQUENCY_ID, PAYMENT_FREQUENCY_NAME FROM PISD.T_PISD_INSRNC_PAYMENT_PERIOD WHERE POLICY_PAYMENT_FREQUENCY_TYPE = :POLICY_PAYMENT_FREQUENCY_TYPE 
PISD.INSERT_INSURANCE_CONTRACT=conPISD; INSERT INTO PISD.T_PISD_INSURANCE_CONTRACT (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, CONTRACT_FIRST_VERFN_DIGIT_ID, CONTRACT_SECOND_VERFN_DIGIT_ID, POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, INSURANCE_COMPANY_ID, INSURANCE_MANAGER_ID, INSURANCE_PROMOTER_ID, CONTRACT_MANAGER_BRANCH_ID, CONTRACT_INCEPTION_DATE, INSURANCE_CONTRACT_START_DATE, INSRNC_VALIDITY_MONTHS_NUMBER, CUSTOMER_ID, DOMICILE_CONTRACT_ID, CARD_ISSUING_MARK_TYPE, ISSUED_RECEIPT_NUMBER, PAYMENT_FREQUENCY_ID, PREMIUM_AMOUNT, SETTLE_PENDING_PREMIUM_AMOUNT, CURRENCY_ID, INSTALLMENT_PERIOD_FINAL_DATE, INSURED_AMOUNT, BENEFICIARY_TYPE, RENEWAL_NUMBER, CTRCT_DISPUTE_STATUS_TYPE, ENDORSEMENT_POLICY_IND_TYPE, INSRNC_CO_CONTRACT_STATUS_TYPE, CONTRACT_STATUS_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, INSUR_PENDING_DEBT_IND_TYPE, TOTAL_DEBT_AMOUNT, PREV_PEND_BILL_RCPTS_NUMBER, SETTLEMENT_VAR_PREMIUM_AMOUNT, SETTLEMENT_FIX_PREMIUM_AMOUNT, AUTOMATIC_DEBIT_INDICATOR_TYPE, BIOMETRY_TRANSACTION_ID, TELEMARKETING_TRANSACTION_ID, ORIGINAL_PAYMENT_SUBCHANNEL_ID) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :CONTRACT_FIRST_VERFN_DIGIT_ID, :CONTRACT_SECOND_VERFN_DIGIT_ID, :POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :INSURANCE_COMPANY_ID, :INSURANCE_MANAGER_ID, :INSURANCE_PROMOTER_ID, :CONTRACT_MANAGER_BRANCH_ID, TO_DATE(:CONTRACT_INCEPTION_DATE, 'DD/MM/YYYY'), TO_DATE(:INSURANCE_CONTRACT_START_DATE, 'DD/MM/YYYY'), :INSRNC_VALIDITY_MONTHS_NUMBER, :CUSTOMER_ID, :DOMICILE_CONTRACT_ID, :CARD_ISSUING_MARK_TYPE, :ISSUED_RECEIPT_NUMBER, :PAYMENT_FREQUENCY_ID, :PREMIUM_AMOUNT, :SETTLE_PENDING_PREMIUM_AMOUNT, :CURRENCY_ID, TO_DATE(:INSTALLMENT_PERIOD_FINAL_DATE, 'DD/MM/YYYY'), :INSURED_AMOUNT, :BENEFICIARY_TYPE, :RENEWAL_NUMBER, :CTRCT_DISPUTE_STATUS_TYPE, :ENDORSEMENT_POLICY_IND_TYPE, :INSRNC_CO_CONTRACT_STATUS_TYPE, :CONTRACT_STATUS_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :INSUR_PENDING_DEBT_IND_TYPE, :TOTAL_DEBT_AMOUNT, :PREV_PEND_BILL_RCPTS_NUMBER, :SETTLEMENT_VAR_PREMIUM_AMOUNT, :SETTLEMENT_FIX_PREMIUM_AMOUNT, :AUTOMATIC_DEBIT_INDICATOR_TYPE, :BIOMETRY_TRANSACTION_ID, :TELEMARKETING_TRANSACTION_ID, :ORIGINAL_PAYMENT_SUBCHANNEL_ID) 

PISD.SELECT_INSURANCE_CONTRACT_DETAIL=conPISD;SELECT c.POLICY_ID AS POLICYID, \
  c.INSURANCE_COMPANY_PRODUCT_ID AS PRODUCTID, \
  TO_CHAR(c.INSURANCE_CONTRACT_START_DATE, 'YYYY-MM-DD') AS INSURANCE_CONTRACT_START_DATE, \
  TO_CHAR(c.INSURANCE_CONTRACT_END_DATE, 'YYYY-MM-DD') AS INSURANCE_CONTRACT_END_DATE, \
  c.INSURANCE_MODALITY_TYPE, TO_CHAR(c.POLICY_ANNULATION_DATE, 'YYYY-MM-DD') AS POLICY_ANNULATION_DATE, \
  TO_CHAR(c.POLICY_ANNULATION_DATE, 'YYYY-MM-DD') AS INSURANCE_CANCEL_DATE, \
  c.INSURED_AMOUNT, \
  c.CURRENCY_ID, \
  c.INSURANCE_COMPANY_ID, \
  TO_CHAR(c.CONTRACT_INCEPTION_DATE, 'YYYY-MM-DD') AS CONTRACT_INCEPTION_DATE, \
  c.PREMIUM_AMOUNT, \
  TO_CHAR(c.PERIOD_NEXT_PAYMENT_DATE, 'YYYY-MM-DD') AS PERIOD_NEXT_PAYMENT_DATE, \
  c.PAYMENT_FREQUENCY_ID, \
  c.CUSTOMER_ID, \
  c.POLICY_QUOTA_INTERNAL_ID, \
  c.INSURANCE_PRODUCT_ID, \
  c.AUTOMATIC_DEBIT_INDICATOR_TYPE, \
  c.RENEWAL_NUMBER, \
  c.NEXT_RENEWAL_START_DATE, \
  c.INSURANCE_CONTRACT_ENTITY_ID, \
  c.INSURANCE_CONTRACT_BRANCH_ID, \
  c.INSURANCE_MANAGER_ID, \
  com.INSURANCE_COMPANY_DESC, \
  com.INSRNC_CO_CONTACT_CHANNEL_DESC, \
  p.INSURANCE_PRODUCT_TYPE, \
  p.INSURANCE_PRODUCT_DESC, \
  mp.INSUR_MODALITY_DESC, \
  pd.PAYMENT_FREQUENCY_NAME, \
  con.INSURANCE_CONSIDERATION_TYPE, \
  con.INSURANCE_CONSIDERATION_ID, \
  con.INSURANCE_CONSIDERATION_DESC, \
  con.INSURANCE_CONSIDERATION_PER, \
  con.INSURANCE_CONSIDERATION_AMOUNT, \
  con.CURRENCY_ID AS CONSIDERATION_CURRENCY_ID, \
  ctg_status.CATALOG_ELEMENT_ID AS CONTRACT_STATUS_ID, \
  ctg_contact.CATALOG_ELEMENT_DESC AS INSRNC_CO_CONTACT_CHANNEL_TYPE, \
  ctg_ut.CATALOG_ELEMENT_DESC AS INSRC_CNSD_DATA_VALUE_TYPE, \
  ctg_pay_frec.CATALOG_ELEMENT_DESC AS POLICY_PAYMENT_FREQUENCY_TYPE, \
  FROM \
    PISD.T_PISD_INSURANCE_CONTRACT c \
    LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON c.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID \
    LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY mp ON c.INSURANCE_PRODUCT_ID = mp.INSURANCE_PRODUCT_ID AND c.INSURANCE_MODALITY_TYPE = mp.INSURANCE_MODALITY_TYPE \
    LEFT JOIN PISD.T_PISD_INSURANCE_COMPANY com ON c.INSURANCE_COMPANY_ID = com.INSURANCE_COMPANY_ID LEFT JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD pd ON c.PAYMENT_FREQUENCY_ID = pd.PAYMENT_FREQUENCY_ID \
    LEFT JOIN PISD.T_PISD_MODALITY_INSRNC_CNSD mc ON c.INSURANCE_PRODUCT_ID = mc.INSURANCE_PRODUCT_ID AND c.INSURANCE_MODALITY_TYPE = mc.INSURANCE_MODALITY_TYPE \
    LEFT JOIN PISD.T_PISD_INSRNC_CONSIDERATION con ON mc.INSURANCE_CONSIDERATION_ID = con.INSURANCE_CONSIDERATION_ID \
    LEFT JOIN PISD.T_PISD_INSURANCE_CATALOG ctg_status on c.CONTRACT_STATUS_ID = ctg_status.CATALOG_ELEMENT_ID AND ctg_status.KEY_CATALOG_ID = :ESTADO_DE_POLIZA \
    LEFT JOIN PISD.T_PISD_INSURANCE_CATALOG ctg_contact on com.INSRNC_CO_CONTACT_CHANNEL_TYPE = ctg_contact.CATALOG_ELEMENT_ID AND ctg_contact.KEY_CATALOG_ID = :TIPO_DE_CONTACTO \
    LEFT JOIN PISD.T_PISD_INSURANCE_CATALOG ctg_ut on con.INSRC_CNSD_DATA_VALUE_TYPE = ctg_ut.CATALOG_ELEMENT_ID AND ctg_ut.KEY_CATALOG_ID = :TIPO_DE_UNIDAD \
    LEFT JOIN PISD.T_PISD_INSURANCE_CATALOG ctg_pay_frec on pd.POLICY_PAYMENT_FREQUENCY_TYPE = ctg_pay_frec.CATALOG_ELEMENT_ID AND ctg_pay_frec.KEY_CATALOG_ID = :FRECUENCIA_DE_PAGO \
  WHERE \
    c.INSURANCE_CONTRACT_ENTITY_ID = :ENTITY_ID AND \
    c.INSURANCE_CONTRACT_BRANCH_ID = :BRANCH_ID AND \
    c.INSRC_CONTRACT_INT_ACCOUNT_ID = :ACCOUNT_ID


PISD.SELECT_INSURANCE_RECEIPTS_DETAIL=conPISD; SELECT INSURANCE_CONTRACT_ENTITY_ID,\
  INSURANCE_CONTRACT_BRANCH_ID,\
  INSRC_CONTRACT_INT_ACCOUNT_ID,\
  POLICY_RECEIPT_ID,\
  PREMIUM_PAYMENT_RECEIPT_AMOUNT,\
  INSRNC_CO_RECEIPT_STATUS_TYPE,\
  RECEIPT_STATUS_TYPE,\
  RENEWAL_RECEIPT_SEQ_NUMBER,\
  RENEWAL_NUMBER,\
  RECEIPT_ISSUE_DATE,\
  TO_CHAR(RECEIPT_START_DATE, 'YYYY-MM-DD') AS RECEIPT_START_DATE,\
  TO_CHAR(RECEIPT_END_DATE, 'YYYY-MM-DD') AS RECEIPT_END_DATE,\
  TO_CHAR(RECEIPT_EXPIRATION_DATE, 'YYYY-MM-DD') AS RECEIPT_EXPIRATION_DATE\
  FROM \
    PISD.T_PISD_INSURANCE_CTR_RECEIPTS\
  WHERE \
    INSURANCE_CONTRACT_ENTITY_ID = :ENTITY_ID AND\
    INSURANCE_CONTRACT_BRANCH_ID = :BRANCH_ID AND\
    INSRC_CONTRACT_INT_ACCOUNT_ID = :ACCOUNT_ID